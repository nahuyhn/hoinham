<!DOCTYPE html>
<html>
<head>
<title>@hoinhamo - Báº£ng Xáº¿p Háº¡ng</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata">
<style>
body, html {
  height: 100%;
  font-family: "Inconsolata", sans-serif;
}
.bgimg {
  background-position: center;
  background-size: cover;
  background-image: url("/image-web/header2.jpg");
  min-height: 75%;
}
</style>
</head>
<body>

<!-- Navbar -->
<div class="w3-top">
  <div class="w3-row w3-padding w3-black">
    <div class="w3-col s3"><a href="index.html" class="w3-button w3-block w3-black">NHÃ€</a></div>
    <div class="w3-col s3"><a href="about.html" class="w3-button w3-block w3-black">Vá»€ CHÃšNG MÃŒNH</a></div>
    <div class="w3-col s3"><a href="contact.html" class="w3-button w3-block w3-black">LIÃŠN Káº¾T</a></div>
    <div class="w3-col s3"><a href="motime.html" class="w3-button w3-block w3-black">!Äáº¶C BIá»†T!</a></div>
  </div>
</div>

<!-- Main Content -->
<div class="w3-container w3-padding-64 w3-light-grey">
  <h2 class="w3-center">Sá» BÃ€I ÄÄ‚NG CÃC THÃ€NH VIÃŠN</h2>
  <table id="rankingTable" class="w3-table w3-bordered w3-striped w3-large w3-center">
    <!-- Dá»¯ liá»‡u tá»« Google Sheets sáº½ Ä‘Æ°á»£c thÃªm vÃ o Ä‘Ã¢y -->
  </table>
</div>

<div class="w3-container w3-padding-64 w3-white">
  <h2 class="w3-center">BÃ€I ÄÄ‚NG Ná»”I Báº¬T</h2>
  <table id="featuredPostsTable" class="w3-table w3-bordered w3-striped w3-large w3-center">
    <!-- Dá»¯ liá»‡u tá»« Google Sheets sáº½ Ä‘Æ°á»£c thÃªm vÃ o Ä‘Ã¢y -->
  </table>
</div>

<!-- Back Home Button -->
<div class="w3-center w3-padding-64">
    <a href="index.html" class="w3-button w3-black w3-padding-large w3-round">Vá»€ NHÃ€</a>
</div>

<!-- Footer -->
<footer class="w3-center w3-light-grey w3-padding-48 w3-large">
  <p>Template by w3.css and remake by @hoinhamo</p>
</footer>

<script>
  async function fetchGoogleSheet(url, tableId, isFeaturedPosts = false) {
    const response = await fetch(url + "&_=" + new Date().getTime());
    const text = await response.text();
    const rows = text.trim().split("\n").map(row => row.split(","));

    let table = document.getElementById(tableId);
    table.innerHTML = ""; // XÃ³a ná»™i dung cÅ©

    // âœ… Táº¡o header cá»§a báº£ng
    let headerRow = document.createElement("tr");
    headerRow.classList.add("w3-black");

    // Náº¿u lÃ  báº£ng bÃ i Ä‘Äƒng ná»•i báº­t, chá»‰ hiá»ƒn thá»‹ hai cá»™t Ä‘áº§u
    let headers = isFeaturedPosts ? rows[0].slice(0, 2) : rows[0];

    headers.forEach(header => {
        let th = document.createElement("th");
        th.innerText = header;
        headerRow.appendChild(th);
    });
    table.appendChild(headerRow);

    // âœ… ThÃªm dá»¯ liá»‡u báº£ng vá»›i Ä‘á»‹nh dáº¡ng mong muá»‘n
    for (let i = 1; i < rows.length; i++) {
        let row = document.createElement("tr");

        if (isFeaturedPosts) {
            // Chá»‰ hiá»ƒn thá»‹ 2 cá»™t Ä‘áº§u, cá»™t thá»© 3 Ä‘Æ°á»£c dÃ¹ng lÃ m link
            let postName = rows[i][1]; // Cá»™t tiÃªu Ä‘á» bÃ i viáº¿t
            let postLink = rows[i][2]; // Cá»™t chá»©a URL

            let tdIndex = document.createElement("td");
            tdIndex.innerText = rows[i][0]; // Chá»‰ sá»‘ bÃ i viáº¿t
            row.appendChild(tdIndex);

            let tdTitle = document.createElement("td");
            let link = document.createElement("a");
            link.href = postLink;
            link.target = "_blank";
            link.innerText = postName;
            tdTitle.appendChild(link);
            row.appendChild(tdTitle);
        } else {
            // Hiá»ƒn thá»‹ toÃ n bá»™ dá»¯ liá»‡u báº£ng xáº¿p háº¡ng
            rows[i].forEach(cell => {
                let td = document.createElement("td");
                td.innerText = cell;
                row.appendChild(td);
            });
        }

        table.appendChild(row);
    }
}

// ğŸ”¹ Link Google Sheets (CSV format)
const rankingSheet = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSqFNsVD_XAHVuNjd7Uve62OMe7yo1RvTYA6U0bpUEVtRcJUcj4XT2o4KSsYLG6WplDwaieFijG9X9Q/pub?output=csv";
const featuredPostsSheet = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSDFNMBktXe4yH76HjfIDzusnyLrkLSMFYV3SfkgoBLaWq5sBxmrnSlReReI2UscZDUJ6u43mrTi51N/pub?output=csv";

// ğŸ”¹ Gá»i hÃ m fetch dá»¯ liá»‡u cho cáº£ hai báº£ng
fetchGoogleSheet(rankingSheet, "rankingTable");
fetchGoogleSheet(featuredPostsSheet, "featuredPostsTable", true);
</script>
</body>
</html>
